<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Comprehensive Phytological Evaluation Platform powered by AI and Machine Learning"
    />
    <title>FloraInsight | AI-Powered Plant Diagnostics Platform</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <style>
      :root {
        --primary-color: #2a9d8f;
        --secondary-color: #264653;
        --accent-color: #e9c46a;
        --success-color: #2a9d8f;
        --danger-color: #e76f51;
        --light-bg: #f8f9fa;
        --text-dark: #2b2d42;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Poppins", sans-serif;
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        color: var(--text-dark);
        min-height: 100vh;
        padding: 2rem;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 1.5rem;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        padding: 2.5rem;
        -webkit-backdrop-filter: blur(10px);
        backdrop-filter: blur(10px);
      }

      .header {
        text-align: center;
        margin-bottom: 3rem;
      }

      .header h1 {
        font-size: 2.5rem;
        color: var(--secondary-color);
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 1rem;
      }

      .header p {
        color: #6c757d;
        font-size: 1.1rem;
        max-width: 600px;
        margin: 0 auto;
        line-height: 1.6;
      }

      .workflow-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 2rem;
        margin-bottom: 3rem;
      }

      .card {
        background: white;
        padding: 2rem;
        border-radius: 1rem;
        text-align: center;
        transition: transform 0.3s ease;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
      }

      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
      }

      .card-icon {
        font-size: 2.5rem;
        color: var(--primary-color);
        margin-bottom: 1rem;
      }

      .upload-section {
        margin: 3rem 0;
      }

      .upload-container {
        border: 2px dashed var(--primary-color);
        border-radius: 1rem;
        padding: 3rem 2rem;
        text-align: center;
        position: relative;
        transition: all 0.3s ease;
        background: rgba(42, 157, 143, 0.05);
      }

      .upload-container.dragover {
        background: rgba(42, 157, 143, 0.1);
        border-color: var(--secondary-color);
      }

      .upload-prompt {
        cursor: pointer;
      }

      .upload-icon {
        font-size: 3rem;
        color: var(--primary-color);
        margin-bottom: 1rem;
      }

      .upload-text {
        color: var(--secondary-color);
        font-weight: 500;
        margin-bottom: 0.5rem;
      }

      .upload-subtext {
        color: #6c757d;
        font-size: 0.9rem;
      }

      #imagePreview {
        max-width: 100%;
        max-height: 400px;
        border-radius: 1rem;
        margin-top: 2rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        display: none;
      }

      .analysis-controls {
        margin-top: 2rem;
        display: flex;
        gap: 1rem;
        justify-content: center;
      }

      button {
        padding: 0.8rem 2rem;
        border: none;
        border-radius: 0.5rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
      }

      .analyze-btn {
        background: var(--primary-color);
        color: white;
      }

      .analyze-btn:hover {
        background: #23857a;
        box-shadow: 0 4px 6px rgba(42, 157, 143, 0.3);
      }

      .download-btn {
        background: var(--secondary-color);
        color: white;
      }

      .download-btn:hover {
        background: #1d3557;
        box-shadow: 0 4px 6px rgba(38, 70, 83, 0.3);
      }

      .result-section {
        margin-top: 3rem;
        display: none;
      }

      .analysis-result {
        background: white;
        padding: 2rem;
        border-radius: 1rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
      }

      .result-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
        margin-top: 2rem;
      }

      .result-card {
        padding: 1.5rem;
        background: var(--light-bg);
        border-radius: 0.8rem;
      }

      .result-card h3 {
        color: var(--primary-color);
        margin-bottom: 1rem;
      }

      .loading-state {
        display: none;
        text-align: center;
        padding: 2rem;
      }

      .loading-spinner {
        width: 3rem;
        height: 3rem;
        border: 4px solid #f3f3f3;
        border-top: 4px solid var(--primary-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 1rem;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .feature-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 2rem;
        margin-top: 3rem;
      }

      .feature-card {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1.5rem;
        background: white;
        border-radius: 0.8rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
      }

      .feature-icon {
        font-size: 1.5rem;
        color: var(--primary-color);
      }

      footer {
        text-align: center;
        margin-top: 3rem;
        color: #6c757d;
        font-size: 0.9rem;
      }
      .error-card {
        background: #fff0f0;
        border-left: 4px solid #e74c3c;
        padding: 1.5rem;
        border-radius: 0.5rem;
        color: #e74c3c;
      }

      .error-card i {
        font-size: 2rem;
        margin-bottom: 1rem;
      }

      .error-card h3 {
        margin-bottom: 0.5rem;
      }

      @media (max-width: 768px) {
        .container {
          padding: 1.5rem;
        }

        .header h1 {
          font-size: 2rem;
        }

        .analysis-controls {
          flex-direction: column;
        }

        button {
          width: 100%;
          justify-content: center;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header class="header">
        <h1><i class="fas fa-seedling"></i>FloraInsight</h1>
        <p>
          Leverage advanced artificial intelligence for comprehensive plant
          health diagnostics, species identification, and personalized care
          recommendations.
        </p>
      </header>

      <section class="workflow-cards">
        <div class="card">
          <i class="fas fa-cloud-upload-alt card-icon"></i>
          <h3>Upload Sample</h3>
          <p>Supported formats: JPEG, PNG, HEIC</p>
        </div>
        <div class="card">
          <i class="fas fa-microscope card-icon"></i>
          <h3>AI Analysis</h3>
          <p>Deep learning-powered diagnostics</p>
        </div>
        <div class="card">
          <i class="fas fa-file-certificate card-icon"></i>
          <h3>Get Report</h3>
          <p>Download detailed PDF analysis</p>
        </div>
      </section>

      <section class="upload-section">
        <div class="upload-container" id="dropZone">
          <div class="upload-prompt" id="uploadTrigger">
            <i class="fas fa-cloud-upload-alt upload-icon"></i>
            <p class="upload-text">Upload Phytological Sample</p>
            <p class="upload-subtext">
              High-resolution images recommended (max 10MB)
            </p>
            <input type="file" id="imageInput" accept="image/*" hidden />
          </div>
          <img id="imagePreview" alt="Sample preview" />
        </div>

        <div class="analysis-controls">
          <button class="analyze-btn" type="submit" id="analyzeBtn">
            <i class="fas fa-play"></i>Initiate Analysis
          </button>
          <button class="download-btn" id="downloadBtn" disabled>
            <i class="fas fa-download"></i>Download Report
          </button>
        </div>
      </section>

      <div class="loading-state" id="loading">
        <div class="loading-spinner"></div>
        <p>Conducting Comprehensive Analysis...</p>
        <p class="upload-subtext">
          Processing time may vary based on image complexity
        </p>
      </div>

      <section class="result-section" id="resultSection">
        <div class="analysis-result">
          <h2>Diagnostic Report</h2>
          <div class="result-grid" id="resultContent"></div>
        </div>
      </section>

      <section class="feature-section">
        <h2>Advanced Capabilities</h2>
        <div class="feature-grid">
          <div class="feature-card">
            <i class="fas fa-dna feature-icon"></i>
            <div>
              <h3>Genomic Pattern Matching</h3>
              <p>Advanced species recognition algorithms</p>
            </div>
          </div>
          <div class="feature-card">
            <i class="fas fa-heartbeat feature-icon"></i>
            <div>
              <h3>Health Diagnostics</h3>
              <p>Pathogen detection and nutrient analysis</p>
            </div>
          </div>
          <div class="feature-card">
            <i class="fas fa-chart-line feature-icon"></i>
            <div>
              <h3>Growth Analytics</h3>
              <p>Predictive growth modeling and tracking</p>
            </div>
          </div>
        </div>
      </section>

      <footer>
        <p>© 2023 FloraInsight. All rights reserved.</p>
        <p>Advanced Phytological Diagnostics Platform</p>
        <br>
        <h4>Made by Akshayaa💚</h4>
      </footer>
    </div>

    <script>
      // Enhanced JavaScript with better error handling and UI interactions
      // DOM Elements
const uploadTrigger = document.getElementById('uploadTrigger');
const dropZone = document.getElementById('dropZone');
const imageInput = document.getElementById('imageInput');
const imagePreview = document.getElementById('imagePreview');
const analyzeBtn = document.getElementById('analyzeBtn');
const downloadBtn = document.getElementById('downloadBtn');
const loadingState = document.getElementById('loading');
const resultSection = document.getElementById('resultSection');
const resultContent = document.getElementById('resultContent');

// Global variables
let currentFile = null;
let analysisData = null;

// Event Listeners
uploadTrigger.addEventListener('click', () => imageInput.click());
imageInput.addEventListener('change', handleFileSelect);
dropZone.addEventListener('dragover', handleDragOver);
dropZone.addEventListener('dragleave', handleDragLeave);
dropZone.addEventListener('drop', handleDrop);
analyzeBtn.addEventListener('click', handleAnalysis);
downloadBtn.addEventListener('click', handleDownload);

// Functions
function handleDragOver(e) {
  e.preventDefault();
  dropZone.classList.add('dragover');
}

function handleDragLeave() {
  dropZone.classList.remove('dragover');
}

function handleDrop(e) {
  e.preventDefault();
  dropZone.classList.remove('dragover');
  if (e.dataTransfer.files.length) {
    handleFile(e.dataTransfer.files[0]);
  }
}

function handleFileSelect(e) {
  if (e.target.files.length) {
    handleFile(e.target.files[0]);
  }
}

function handleFile(file) {
  if (!file.type.startsWith('image/')) {
    showError('Please upload an image file (JPEG, PNG)');
    return;
  }

  if (file.size > 10 * 1024 * 1024) {
    showError('File size must be less than 10MB');
    return;
  }

  currentFile = file;
  const reader = new FileReader();
  reader.onload = (e) => {
    imagePreview.src = e.target.result;
    imagePreview.style.display = 'block';
    analyzeBtn.disabled = false;
  };
  reader.readAsDataURL(file);
}

async function handleAnalysis(e) {
  e.preventDefault();
  if (!currentFile) {
    showError('Please select an image first');
    return;
  }

  loadingState.style.display = 'block';
  resultSection.style.display = 'none';
  downloadBtn.disabled = true;

  const formData = new FormData();
  formData.append('image', currentFile);

  try {
    const response = await fetch('/analyze', {
      method: 'POST',
      body: formData
    });

    const data = await response.json();
    
    if (!data.success) {
      throw new Error(data.error || 'Analysis failed');
    }

    analysisData = data;
    displayResults(data);
    downloadBtn.disabled = false;

  } catch (error) {
    showError(`Analysis failed: ${error.message}`);
    console.error('Analysis error:', error);
  } finally {
    loadingState.style.display = 'none';
  }
}

function displayResults(data) {
  resultContent.innerHTML = `
    <div class="result-card">
      <h3><i class="fas fa-leaf"></i> Species Identification</h3>
      <p><strong>Name:</strong> ${data.species.name}</p>
      <p><strong>Family:</strong> ${data.species.family}</p>
      <p><strong>Characteristics:</strong> ${data.species.characteristics}</p>
    </div>
    <div class="result-card">
      <h3><i class="fas fa-heartbeat"></i> Health Assessment</h3>
      <p><strong>Status:</strong> ${data.health.status}</p>
      <p><strong>Issues:</strong></p>
      <ul>${data.health.issues.map(issue => `<li>${issue}</li>`).join('') || '<li>No issues detected</li>'}</ul>
      <p><strong>Assessment:</strong> ${data.health.assessment}</p>
    </div>
    <div class="result-card">
      <h3><i class="fas fa-clipboard-list"></i> Care Recommendations</h3>
      <p><strong>Care Instructions:</strong></p>
      <ul>${data.recommendations.care.map(item => `<li>${item}</li>`).join('') || '<li>No specific instructions</li>'}</ul>
      <p><strong>Treatment:</strong></p>
      <ul>${data.recommendations.treatment.map(item => `<li>${item}</li>`).join('') || '<li>No treatment needed</li>'}</ul>
      <p><strong>Notes:</strong> ${data.recommendations.notes}</p>
    </div>
    ${data.interesting_facts ? `
    <div class="result-card">
      <h3><i class="fas fa-lightbulb"></i> Interesting Facts</h3>
      <p>${data.interesting_facts}</p>
    </div>` : ''}
  `;
  resultSection.style.display = 'block';
}

async function handleDownload() {
  if (!analysisData) return;

  try {
    const response = await fetch('/download', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(analysisData)
    });

    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.error || 'Download failed');
    }

    // Handle the PDF download
    const blob = await response.blob();
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `PlantReport_${Date.now()}.pdf`;
    document.body.appendChild(a);
    a.click();
    a.remove();
    window.URL.revokeObjectURL(url);

  } catch (error) {
    showError(`Download failed: ${error.message}`);
    console.error('Download error:', error);
  }
}

function showError(message) {
  resultContent.innerHTML = `
    <div class="error-card">
      <i class="fas fa-exclamation-triangle"></i>
      <h3>Error</h3>
      <p>${message}</p>
      <p>Please try again.</p>
    </div>
  `;
  resultSection.style.display = 'block';
}
    </script>
  </body>
</html>
